{% extends "catalog/base.html" %}
{% load static %}

{% block content %}
<section class="section section-favorites">
    <div class="fake fake2"><br></div>
    <div class="favorites-container">
        <h1 class="favorites-title">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h1>

         {% if user.is_authenticated %}
        <!-- –°–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ -->
        {% if favorites %}
        <div class="favorites-items">
            {% for item in favorites %}
            <div class="favorite-item" data-product-id="{{ item.product.id }}">
                <div class="item-image">
                    <a href="{% url 'catalog:product_detail' item.product.id %}">
                        <img src="{{ item.product.imgg.url }}" alt="{{ item.product.title }}"
                             style="{% if not item.product.is_in_stock %}filter: grayscale(100%); opacity: 0.6;{% endif %}">
                    </a>
                </div>
                <div class="item-details">
                    <div class="item-header">
                        <h3 class="item-title">
                            <a href="{% url 'catalog:product_detail' item.product.id %}">{{ item.product.title }}</a>
                        </h3>
                         <a href="#" onclick="removeFromFavoritesPage({{ item.product.id }}, '{{ csrf_token }}')">
                            <img class="cart-group-png cart-group-png2" src="{% static 'image/die.png' %}">
                         </a>
                    </div>

                    {% if not item.product.is_in_stock %}
                        <div class="item-brand" style="color: #e53935; font-weight: 600;">–¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è</div>
                    {% endif %}

                    <div class="item-brand">{{ item.product.brendd }}</div>
                    <div class="item-price">{{ item.product.summ|floatformat:"0" }} ‚ÇΩ</div>

                    <div class="item-actions">
                        <div class="size-selector">
                            <select class="size-select" id="sizeSelect{{ item.product.id }}" {% if not item.product.is_in_stock %}disabled{% endif %}>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä</option>
                                {% for stock_item in item.product.stock_set.all %}
                                    {% if stock_item.quantity > 0 %}
                                    <option value="{{ stock_item.size.id }}">{{ stock_item.size.name }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                            <div class="size-error" id="sizeError{{ item.product.id }}"></div>
                        </div>
                        <button class="add-to-cart-from-fav"
                                onclick="addToCartFromFavorites({{ item.product.id }}, '{% url "catalog:add_to_cart" 0 %}')"
                                {% if not item.product.is_in_stock %}disabled style="background-color: #ccc; cursor: not-allowed; border-color: #ccc;"{% endif %}>
                            <span class="cart-icon">üõí</span> –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

       <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—É—Å—Ç–æ–≥–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ —É –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            {% else %}
            <div class="empty-favorites">
                <div class="empty-icon">‚ù§</div>
                <h3>–í–∞—à —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—É—Å—Ç</h3>
                <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã, –Ω–∞–∂–∏–º–∞—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É</p>
                <a href="{% url 'catalog:view_product' %}" class="browse-btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
            </div>
            {% endif %}
        {% else %}
            <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="empty-favorites">
                <div class="empty-icon">‚ù§</div>
                <h3>–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
                <p>–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏—Ö</p>
                <a href="{% url 'login' %}?next={{ request.path }}" class="browse-btn">–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</a>
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block page_scripts %}
<script src="{% static 'js/favorites-page.js' %}"></script>
{% endblock %}